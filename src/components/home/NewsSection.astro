---
// News and Announcements Component
interface NewsItem {
  id: string;
  title: string;
  excerpt: string;
  image?: string;
  publishedAt: string;
  slug: string;
  category?: string;
}

interface Props {
  news?: NewsItem[];
}

const { news = [] } = Astro.props;

// Default news items
const defaultNews: NewsItem[] = [
  {
    id: '1',
    title: 'Penerimaan Mahasiswa Baru Gelombang 2 Tahun 2025',
    excerpt: 'UIT membuka pendaftaran mahasiswa baru untuk berbagai program studi unggulan. Daftar sekarang dan raih masa depan cerah Anda!',
    publishedAt: '2025-12-15',
    slug: 'pmb-gelombang-2-2025',
    category: 'Pengumuman'
  },
  {
    id: '2',
    title: 'Seminar Nasional Teknologi dan Inovasi 2025',
    excerpt: 'UIT mengadakan seminar nasional dengan tema "Teknologi untuk Masa Depan Berkelanjutan" dengan pembicara dari berbagai universitas ternama.',
    publishedAt: '2025-12-10',
    slug: 'seminar-nasional-teknologi-2025',
    category: 'Kegiatan'
  },
  {
    id: '3',
    title: 'Mahasiswa UIT Raih Juara 1 Kompetisi Nasional',
    excerpt: 'Tim mahasiswa UIT berhasil meraih juara 1 dalam kompetisi inovasi teknologi tingkat nasional yang diikuti oleh 50 universitas.',
    publishedAt: '2025-12-08',
    slug: 'mahasiswa-juara-kompetisi',
    category: 'Prestasi'
  },
  {
    id: '4',
    title: 'Kerja Sama dengan Industri untuk Program Magang',
    excerpt: 'UIT menjalin kerja sama strategis dengan berbagai perusahaan multinasional untuk program magang dan penempatan kerja mahasiswa.',
    publishedAt: '2025-12-05',
    slug: 'kerjasama-industri-magang',
    category: 'Berita'
  },
  {
    id: '5',
    title: 'Beasiswa Prestasi untuk Mahasiswa Berprestasi',
    excerpt: 'UIT menyediakan berbagai program beasiswa untuk mahasiswa berprestasi akademik dan non-akademik. Info lengkap dan cara pendaftaran.',
    publishedAt: '2025-12-01',
    slug: 'beasiswa-prestasi-2025',
    category: 'Pengumuman'
  },
  {
    id: '6',
    title: 'Fasilitas Laboratorium Baru Diresmikan',
    excerpt: 'UIT meresmikan laboratorium komputer dan riset terbaru dengan teknologi canggih untuk mendukung pembelajaran mahasiswa.',
    publishedAt: '2025-11-28',
    slug: 'laboratorium-baru-diresmikan',
    category: 'Berita'
  }
];

const newsItems = news.length > 0 ? news : defaultNews;

function formatDate(dateString: string): string {
  const date = new Date(dateString);
  return date.toLocaleDateString('id-ID', { 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric' 
  });
}

const categoryColors: Record<string, string> = {
  'Pengumuman': 'bg-uit-green/10 text-uit-green-dark',
  'Kegiatan': 'bg-uit-green-light/20 text-uit-green-dark',
  'Prestasi': 'bg-yellow-100 text-yellow-800',
  'Berita': 'bg-uit-green/20 text-uit-green-dark'
};
---

<section class="py-16 md:py-20 bg-white">
  <div class="container mx-auto px-4">
    <!-- Section Header -->
    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-12">
      <div>
        <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">
          Berita & Pengumuman
        </h2>
        <p class="text-lg text-gray-600">
          Informasi terkini seputar kegiatan dan pencapaian UIT
        </p>
      </div>
      <a 
        href="/berita" 
        class="mt-4 md:mt-0 inline-flex items-center text-uit-green hover:text-uit-green-dark font-semibold"
      >
        Lihat Semua Berita
        <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
      </a>
    </div>

    <!-- News Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
      {newsItems.map((item) => (
        <article class="bg-white rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-shadow group">
          <!-- Image -->
          <div class="aspect-video bg-gradient-to-br from-uit-green-light/30 to-uit-green/30 overflow-hidden">
            {item.image ? (
              <img 
                src={item.image} 
                alt={item.title}
                class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
              />
            ) : (
              <div class="w-full h-full flex items-center justify-center">
                <svg class="w-16 h-16 text-uit-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
                </svg>
              </div>
            )}
          </div>

          <!-- Content -->
          <div class="p-6">
            <!-- Category & Date -->
            <div class="flex items-center justify-between mb-3">
              {item.category && (
                <span class={`text-xs px-3 py-1 rounded-full font-semibold ${categoryColors[item.category] || 'bg-gray-100 text-gray-800'}`}>
                  {item.category}
                </span>
              )}
              <span class="text-xs text-gray-500">
                {formatDate(item.publishedAt)}
              </span>
            </div>

            <!-- Title -->
            <h3 class="text-xl font-bold text-gray-900 mb-2 group-hover:text-uit-green transition-colors line-clamp-2">
              {item.title}
            </h3>

            <!-- Excerpt -->
            <p class="text-gray-600 mb-4 line-clamp-3">
              {item.excerpt}
            </p>

            <!-- Read More -->
            <a 
              href={`/berita/${item.slug}`}
              class="inline-flex items-center text-uit-green hover:text-uit-green-dark font-semibold"
            >
              Baca Selengkapnya
              <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </a>
          </div>
        </article>
      ))}
    </div>
  </div>
</section>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
